<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>pwnable.kr - collision | 0xRick</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="pwnable.kr - collision" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My write-up for collision from pwnable.kr." />
<meta property="og:description" content="My write-up for collision from pwnable.kr." />
<link rel="canonical" href="https://0xrick.github.io/pwn/collision/" />
<meta property="og:url" content="https://0xrick.github.io/pwn/collision/" />
<meta property="og:site_name" content="0xRick" />
<meta property="og:image" content="https://0xrick.github.io/pwn/collision/0.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-28T00:00:00+02:00" />
<script type="application/ld+json">
{"description":"My write-up for collision from pwnable.kr.","@type":"BlogPosting","url":"https://0xrick.github.io/pwn/collision/","image":"https://0xrick.github.io/pwn/collision/0.png","headline":"pwnable.kr - collision","dateModified":"2019-08-28T00:00:00+02:00","datePublished":"2019-08-28T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xrick.github.io/pwn/collision/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/ad.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="https://0xrick.github.io/feed.xml" title="0xRick" /><script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js" integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ" crossorigin="anonymous"></script>
</head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2');
</script>

<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">0xRick<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/Ahm3d_H3sham/" target="_blank" rel="noopener noreferrer"><i class="fab fa-twitter"></i></a><a class="color-blue-hover" href="https://facebook.com/Ahm3d.H3sham/" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook"></i></a><a class="color-purple-hover" href="https://github.com/0xRick" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i></a><a class="color-orange-hover" href="https://www.reddit.com/user/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer"><i class="fab fa-reddit"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/332196573771595777" target="_blank" rel="noopener noreferrer"><i class="fab fa-discord"></i></a>
        <a class="color-red-hover" href="mailto:x0rick@protonmail.com"><i class="fa fa-envelope"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">
<img src="/avatar.png" class="author-avatar" onclick="window.open('https://www.hackthebox.eu/profile/65598','_blank');">
<h7>
	Ahmed Hesham<br>
	CyberSec/InfoSec enthusiast. <br>
	Interested in knowing how things work/Interested in breaking them, always learning.
</h7>
</div>

  <br>
<div>
	<h7>    Ad </h7>
	<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script>
</div>
<div class="post">
  <h1 class="post-title">pwnable.kr - collision</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/linux/">linux</a>
      
      <a class="tag" href="/tag/binary-exploitation/">binary-exploitation</a>
      
      <a class="tag" href="/tag/code-analysis/">code-analysis</a>
      
      <a class="tag" href="/tag/exploit-development/">exploit-development</a>
      
      <a class="tag" href="/tag/c/">c</a>
      
      <a class="tag" href="/tag/python/">python</a>
      
  </div>
  
  <div class="post-date">Published on 28 Aug 2019</div>
  
  <div class="post-description">My write-up for collision from pwnable.kr.</div>
  
  <hr>

<h2 id="introduction">Introduction</h2>
<p><br> Hey guys this is my write-up for a challenge called <code class="highlighter-rouge">collision</code> from <a href="http://pwnable.kr/" target="_blank" rel="noopener noreferrer">pwnable.kr</a>. It’s a very simple challenge, we need a password to make the program read the flag, the function that validates the given password is vulnerable to hash collision so we will exploit it.
<br> Challenge Description :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Daddy told me about cool MD5 hash collision today.
I wanna do something like that too!

ssh col@pwnable.kr -p2222 (pw:guest)
</code></pre></div></div>
<p><br><img src="/images/pwn/collision/0.png" alt=""><br></p>
<hr>

<h2 id="code-analysis-tests">Code Analysis, Tests</h2>
<p><br> <code class="highlighter-rouge">col.c</code> :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">hashcode</span> <span class="o">=</span> <span class="mh">0x21DD09EC</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">check_password</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span><span class="p">){</span>
	<span class="kt">int</span><span class="o">*</span> <span class="n">ip</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">res</span> <span class="o">+=</span> <span class="n">ip</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">argc</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"usage : %s [passcode]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"passcode length should be 20 bytes</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span><span class="n">hashcode</span> <span class="o">==</span> <span class="n">check_password</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)){</span>
		<span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"wrong passcode.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p><br> <code class="highlighter-rouge">main()</code> :</p>

<p><br> Starting by the main function it checks if we have given the program an input and it checks if our input’s length is exactly 20 bytes. Then it checks if the return value of <code class="highlighter-rouge">check_password(our input)</code> is equal to <code class="highlighter-rouge">hashcode</code>, if we pass that check it will read the flag, otherwise it will print <code class="highlighter-rouge">wrong passcode.</code> and exit.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">argc</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"usage : %s [passcode]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"passcode length should be 20 bytes</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span><span class="n">hashcode</span> <span class="o">==</span> <span class="n">check_password</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)){</span>
		<span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"wrong passcode.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p><br> Looking up, we can see the declaration of the variable <code class="highlighter-rouge">hashcode</code>  :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">hashcode</span> <span class="o">=</span> <span class="mh">0x21DD09EC</span><span class="p">;</span>
</code></pre></div></div>
<p><br> That’s a hex value, let’s convert it to decimal with python :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="mh">0x21DD09EC</span>
<span class="mi">568134124</span>
</code></pre></div></div>
<p><br> So we need our input to be 20 bytes length and we also need to make the function <code class="highlighter-rouge">check_password</code> return <code class="highlighter-rouge">568134124</code> when our input is given to it.
<br> Let’s quickly try to simulate that in <code class="highlighter-rouge">gdb</code>.
<br> I ran the program and set a breakpoint at main :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gef</span><span class="err">➤</span>  <span class="k">break</span> <span class="n">main</span>                                                                                                                                                                                         
<span class="n">Breakpoint</span> <span class="mi">1</span> <span class="n">at</span> <span class="mh">0x11b3</span>                                                                                                                                                                                   
<span class="n">gef</span><span class="err">➤</span>  <span class="n">r</span> <span class="s">"AAAAAAAAAAAAAAAAAAAA"</span>
<span class="n">Starting</span> <span class="n">program</span><span class="o">:</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">pwnable</span><span class="p">.</span><span class="n">kr</span><span class="o">/</span><span class="n">collision</span><span class="o">/</span><span class="n">col</span> <span class="s">"AAAAAAAAAAAAAAAAAAAA"</span>

<span class="n">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="mh">0x00005555555551b3</span> <span class="n">in</span> <span class="n">main</span> <span class="p">()</span>
<span class="p">[</span> <span class="n">Legend</span><span class="o">:</span> <span class="n">Modified</span> <span class="k">register</span> <span class="o">|</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">Heap</span> <span class="o">|</span> <span class="n">Stack</span> <span class="o">|</span> <span class="n">String</span> <span class="p">]</span>
<span class="err">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">registers</span> <span class="err">────</span>
<span class="err">$</span><span class="n">rax</span>   <span class="o">:</span> <span class="mh">0x00005555555551af</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">rbp</span>
<span class="err">$</span><span class="n">rbx</span>   <span class="o">:</span> <span class="mh">0x0</span> 
<span class="err">$</span><span class="n">rcx</span>   <span class="o">:</span> <span class="mh">0x00007ffff7fa9718</span>  <span class="err">→</span>  <span class="mh">0x00007ffff7faad80</span>  <span class="err">→</span>  <span class="mh">0x0000000000000000</span>
<span class="err">$</span><span class="n">rdx</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe160</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe48b</span>  <span class="err">→</span>  <span class="s">"SHELL=/bin/bash"</span>
<span class="err">$</span><span class="n">rsp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe060</span>  <span class="err">→</span>  <span class="mh">0x0000555555555260</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">r15</span>
<span class="err">$</span><span class="n">rbp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe060</span>  <span class="err">→</span>  <span class="mh">0x0000555555555260</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">r15</span>
<span class="err">$</span><span class="n">rsi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe148</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe44f</span>  <span class="err">→</span>  <span class="s">"/root/Desktop/pwnable.kr/collision/col"</span>
<span class="err">$</span><span class="n">rdi</span>   <span class="o">:</span> <span class="mh">0x2</span>                                                                                                           
<span class="err">$</span><span class="n">rip</span>   <span class="o">:</span> <span class="mh">0x00005555555551b3</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
<span class="err">$</span><span class="n">r8</span>    <span class="o">:</span> <span class="mh">0x00007ffff7faad80</span>  <span class="err">→</span>  <span class="mh">0x0000000000000000</span>
<span class="err">$</span><span class="n">r9</span>    <span class="o">:</span> <span class="mh">0x00007ffff7faad80</span>  <span class="err">→</span>  <span class="mh">0x0000000000000000</span>
<span class="err">$</span><span class="n">r10</span>   <span class="o">:</span> <span class="mh">0x0</span>
<span class="err">$</span><span class="n">r11</span>   <span class="o">:</span> <span class="mh">0x00007ffff7f6b1b0</span>  <span class="err">→</span>  <span class="mh">0x0000800003400468</span>
<span class="err">$</span><span class="n">r12</span>   <span class="o">:</span> <span class="mh">0x0000555555555080</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">_start</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">xor</span> <span class="n">ebp</span><span class="p">,</span> <span class="n">ebp</span>
<span class="err">$</span><span class="n">r13</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe140</span>  <span class="err">→</span>  <span class="mh">0x0000000000000002</span>
<span class="err">$</span><span class="n">r14</span>   <span class="o">:</span> <span class="mh">0x0</span>
<span class="err">$</span><span class="n">r15</span>   <span class="o">:</span> <span class="mh">0x0</span>
<span class="err">$</span><span class="n">eflags</span><span class="o">:</span> <span class="p">[</span><span class="n">ZERO</span> <span class="n">carry</span> <span class="n">PARITY</span> <span class="n">adjust</span> <span class="n">sign</span> <span class="n">trap</span> <span class="n">INTERRUPT</span> <span class="n">direction</span> <span class="n">overflow</span> <span class="n">resume</span> <span class="n">virtualx86</span> <span class="n">identification</span><span class="p">]</span>
<span class="err">$</span><span class="n">cs</span><span class="o">:</span> <span class="mh">0x0033</span> <span class="err">$</span><span class="n">ss</span><span class="o">:</span> <span class="mh">0x002b</span> <span class="err">$</span><span class="n">ds</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="err">$</span><span class="n">es</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="err">$</span><span class="n">fs</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="err">$</span><span class="n">gs</span><span class="o">:</span> <span class="mh">0x0000</span>
<span class="err">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">stack</span> <span class="err">────</span>
<span class="mh">0x00007fffffffe060</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0000</span><span class="o">:</span> <span class="mh">0x0000555555555260</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">r15</span>  <span class="err">←</span> <span class="err">$</span><span class="n">rsp</span><span class="p">,</span> <span class="err">$</span><span class="n">rbp</span>
<span class="mh">0x00007fffffffe068</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0008</span><span class="o">:</span> <span class="mh">0x00007ffff7e1209b</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_start_main</span><span class="o">+</span><span class="mi">235</span><span class="o">&gt;</span> <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">eax</span>
<span class="mh">0x00007fffffffe070</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0010</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffe078</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0018</span><span class="o">:</span> <span class="mh">0x00007fffffffe148</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe44f</span>  <span class="err">→</span>  <span class="s">"/root/Desktop/pwnable.kr/collision/col"</span>
<span class="mh">0x00007fffffffe080</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0020</span><span class="o">:</span> <span class="mh">0x0000000200040000</span>
<span class="mh">0x00007fffffffe088</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0028</span><span class="o">:</span> <span class="mh">0x00005555555551af</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">rbp</span>
<span class="mh">0x00007fffffffe090</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0030</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffe098</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0038</span><span class="o">:</span> <span class="mh">0xf6e7f80b45a87e3d</span>
<span class="err">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">code</span><span class="o">:</span><span class="n">x86</span><span class="o">:</span><span class="mi">64</span> <span class="err">────</span>
   <span class="mh">0x5555555551ae</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">73</span><span class="o">&gt;</span> <span class="n">ret</span>
   <span class="mh">0x5555555551af</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span>         <span class="n">push</span>   <span class="n">rbp</span>
   <span class="mh">0x5555555551b0</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span>         <span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
 <span class="err">→</span> <span class="mh">0x5555555551b3</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">4</span><span class="o">&gt;</span>         <span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
   <span class="mh">0x5555555551b7</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">8</span><span class="o">&gt;</span>         <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span> <span class="n">edi</span>
   <span class="mh">0x5555555551ba</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">11</span><span class="o">&gt;</span>        <span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x10</span><span class="p">],</span> <span class="n">rsi</span>
   <span class="mh">0x5555555551be</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">15</span><span class="o">&gt;</span>        <span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span> <span class="mh">0x1</span>
   <span class="mh">0x5555555551c2</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">19</span><span class="o">&gt;</span>        <span class="n">jg</span>     <span class="mh">0x5555555551e6</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">55</span><span class="o">&gt;</span>
   <span class="mh">0x5555555551c4</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">21</span><span class="o">&gt;</span>        <span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span> <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x10</span><span class="p">]</span>
<span class="err">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">threads</span> <span class="err">────</span>
<span class="p">[</span><span class="err">#</span><span class="mi">0</span><span class="p">]</span> <span class="n">Id</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Name</span><span class="o">:</span> <span class="s">"col"</span><span class="p">,</span> <span class="n">stopped</span><span class="p">,</span> <span class="n">reason</span><span class="o">:</span> <span class="n">BREAKPOINT</span>
<span class="err">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">trace</span> <span class="err">────</span>
<span class="p">[</span><span class="err">#</span><span class="mi">0</span><span class="p">]</span> <span class="mh">0x5555555551b3</span> <span class="err">→</span> <span class="n">main</span><span class="p">()</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="n">gef</span><span class="err">➤</span>
</code></pre></div></div>
<p><br> Then I set a breakpoint before the return instruction in <code class="highlighter-rouge">check_password()</code> and continued the execution :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">check_password</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">check_password</span><span class="o">:</span>
   <span class="mh">0x0000555555555165</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>     <span class="n">push</span>   <span class="n">rbp</span>
   <span class="mh">0x0000555555555166</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>     <span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">rsp</span>
   <span class="mh">0x0000555555555169</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>     <span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x18</span><span class="p">],</span><span class="n">rdi</span>
   <span class="mh">0x000055555555516d</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span>     <span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x18</span><span class="p">]</span>
   <span class="mh">0x0000555555555171</span> <span class="o">&lt;+</span><span class="mi">12</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x10</span><span class="p">],</span><span class="n">rax</span>
   <span class="mh">0x0000555555555175</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">],</span><span class="mh">0x0</span>
   <span class="mh">0x000055555555517c</span> <span class="o">&lt;+</span><span class="mi">23</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span><span class="mh">0x0</span>
   <span class="mh">0x0000555555555183</span> <span class="o">&lt;+</span><span class="mi">30</span><span class="o">&gt;:</span>    <span class="n">jmp</span>    <span class="mh">0x5555555551a2</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">61</span><span class="o">&gt;</span>
   <span class="mh">0x0000555555555185</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
   <span class="mh">0x0000555555555188</span> <span class="o">&lt;+</span><span class="mi">35</span><span class="o">&gt;:</span>    <span class="n">cdqe</span>
   <span class="mh">0x000055555555518a</span> <span class="o">&lt;+</span><span class="mi">37</span><span class="o">&gt;:</span>    <span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rax</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mh">0x0</span><span class="p">]</span>
   <span class="mh">0x0000555555555192</span> <span class="o">&lt;+</span><span class="mi">45</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x10</span><span class="p">]</span>
   <span class="mh">0x0000555555555196</span> <span class="o">&lt;+</span><span class="mi">49</span><span class="o">&gt;:</span>    <span class="n">add</span>    <span class="n">rax</span><span class="p">,</span><span class="n">rdx</span>
   <span class="mh">0x0000555555555199</span> <span class="o">&lt;+</span><span class="mi">52</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="p">]</span>
   <span class="mh">0x000055555555519b</span> <span class="o">&lt;+</span><span class="mi">54</span><span class="o">&gt;:</span>    <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">],</span><span class="n">eax</span>
   <span class="mh">0x000055555555519e</span> <span class="o">&lt;+</span><span class="mi">57</span><span class="o">&gt;:</span>    <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span><span class="mh">0x1</span>
   <span class="mh">0x00005555555551a2</span> <span class="o">&lt;+</span><span class="mi">61</span><span class="o">&gt;:</span>    <span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span><span class="mh">0x4</span>
   <span class="mh">0x00005555555551a6</span> <span class="o">&lt;+</span><span class="mi">65</span><span class="o">&gt;:</span>    <span class="n">jle</span>    <span class="mh">0x555555555185</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">32</span><span class="o">&gt;</span>
   <span class="mh">0x00005555555551a8</span> <span class="o">&lt;+</span><span class="mi">67</span><span class="o">&gt;:</span>    <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x00005555555551ab</span> <span class="o">&lt;+</span><span class="mi">70</span><span class="o">&gt;:</span>    <span class="n">cdqe</span>
   <span class="mh">0x00005555555551ad</span> <span class="o">&lt;+</span><span class="mi">72</span><span class="o">&gt;:</span>    <span class="n">pop</span>    <span class="n">rbp</span>
   <span class="mh">0x00005555555551ae</span> <span class="o">&lt;+</span><span class="mi">73</span><span class="o">&gt;:</span>    <span class="n">ret</span>
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
<span class="n">gef</span><span class="err">➤</span>  <span class="k">break</span> <span class="o">*</span><span class="mh">0x00005555555551ae</span>
<span class="n">Breakpoint</span> <span class="mi">2</span> <span class="n">at</span> <span class="mh">0x5555555551ae</span>
<span class="n">gef</span><span class="err">➤</span>  <span class="n">c</span>
<span class="n">Continuing</span><span class="p">.</span>

<span class="n">Breakpoint</span> <span class="mi">2</span><span class="p">,</span> <span class="mh">0x00005555555551ae</span> <span class="n">in</span> <span class="n">check_password</span> <span class="p">()</span>
<span class="p">[</span> <span class="n">Legend</span><span class="o">:</span> <span class="n">Modified</span> <span class="k">register</span> <span class="o">|</span> <span class="n">Code</span> <span class="o">|</span> <span class="n">Heap</span> <span class="o">|</span> <span class="n">Stack</span> <span class="o">|</span> <span class="n">String</span> <span class="p">]</span>
<span class="err">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">registers</span> <span class="err">────</span>
<span class="err">$</span><span class="n">rax</span>   <span class="o">:</span> <span class="mh">0x46464645</span>
<span class="err">$</span><span class="n">rbx</span>   <span class="o">:</span> <span class="mh">0x0</span>
<span class="err">$</span><span class="n">rcx</span>   <span class="o">:</span> <span class="mh">0x6</span>
<span class="err">$</span><span class="n">rdx</span>   <span class="o">:</span> <span class="mh">0x10</span>
<span class="err">$</span><span class="n">rsp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe048</span>  <span class="err">→</span>  <span class="mh">0x0000555555555225</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">118</span><span class="o">&gt;</span> <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">rax</span>
<span class="err">$</span><span class="n">rbp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe060</span>  <span class="err">→</span>  <span class="mh">0x0000555555555260</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">r15</span>
<span class="err">$</span><span class="n">rsi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe148</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe44f</span>  <span class="err">→</span>  <span class="s">"/root/Desktop/pwnable.kr/collision/col"</span>
<span class="err">$</span><span class="n">rdi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe476</span>  <span class="err">→</span>  <span class="s">"AAAAAAAAAAAAAAAAAAAA"</span>
<span class="err">$</span><span class="n">rip</span>   <span class="o">:</span> <span class="mh">0x00005555555551ae</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">73</span><span class="o">&gt;</span> <span class="n">ret</span> 
<span class="err">$</span><span class="n">r8</span>    <span class="o">:</span> <span class="mh">0x400</span>
<span class="err">$</span><span class="n">r9</span>    <span class="o">:</span> <span class="mh">0x00007ffff7faad80</span>  <span class="err">→</span>  <span class="mh">0x0000000000000000</span>
<span class="err">$</span><span class="n">r10</span>   <span class="o">:</span> <span class="mh">0xfffffffffffff479</span>
<span class="err">$</span><span class="n">r11</span>   <span class="o">:</span> <span class="mh">0x00007ffff7e861e0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__strlen_sse2</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">pxor</span> <span class="n">xmm0</span><span class="p">,</span> <span class="n">xmm0</span>
<span class="err">$</span><span class="n">r12</span>   <span class="o">:</span> <span class="mh">0x0000555555555080</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">_start</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">xor</span> <span class="n">ebp</span><span class="p">,</span> <span class="n">ebp</span>
<span class="err">$</span><span class="n">r13</span>   <span class="o">:</span> <span class="mh">0x00007fffffffe140</span>  <span class="err">→</span>  <span class="mh">0x0000000000000002</span>
<span class="err">$</span><span class="n">r14</span>   <span class="o">:</span> <span class="mh">0x0</span>
<span class="err">$</span><span class="n">r15</span>   <span class="o">:</span> <span class="mh">0x0</span>
<span class="err">$</span><span class="n">eflags</span><span class="o">:</span> <span class="p">[</span><span class="n">zero</span> <span class="n">carry</span> <span class="n">parity</span> <span class="n">adjust</span> <span class="n">sign</span> <span class="n">trap</span> <span class="n">INTERRUPT</span> <span class="n">direction</span> <span class="n">overflow</span> <span class="n">resume</span> <span class="n">virtualx86</span> <span class="n">identification</span><span class="p">]</span>
<span class="err">$</span><span class="n">cs</span><span class="o">:</span> <span class="mh">0x0033</span> <span class="err">$</span><span class="n">ss</span><span class="o">:</span> <span class="mh">0x002b</span> <span class="err">$</span><span class="n">ds</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="err">$</span><span class="n">es</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="err">$</span><span class="n">fs</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="err">$</span><span class="n">gs</span><span class="o">:</span> <span class="mh">0x0000</span>
<span class="err">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">stack</span> <span class="err">────</span>
<span class="mh">0x00007fffffffe048</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0000</span><span class="o">:</span> <span class="mh">0x0000555555555225</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">118</span><span class="o">&gt;</span> <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">rax</span>       <span class="err">←</span> <span class="err">$</span><span class="n">rsp</span>
<span class="mh">0x00007fffffffe050</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0008</span><span class="o">:</span> <span class="mh">0x00007fffffffe148</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe44f</span>  <span class="err">→</span>  <span class="s">"/root/Desktop/pwnable.kr/collision/col"</span>
<span class="mh">0x00007fffffffe058</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0010</span><span class="o">:</span> <span class="mh">0x0000000200000000</span>
<span class="mh">0x00007fffffffe060</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0018</span><span class="o">:</span> <span class="mh">0x0000555555555260</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">push</span> <span class="n">r15</span>  <span class="err">←</span> <span class="err">$</span><span class="n">rbp</span>
<span class="mh">0x00007fffffffe068</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0020</span><span class="o">:</span> <span class="mh">0x00007ffff7e1209b</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="n">__libc_start_main</span><span class="o">+</span><span class="mi">235</span><span class="o">&gt;</span> <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="n">eax</span>
<span class="mh">0x00007fffffffe070</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0028</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffe078</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0030</span><span class="o">:</span> <span class="mh">0x00007fffffffe148</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe44f</span>  <span class="err">→</span>  <span class="s">"/root/Desktop/pwnable.kr/collision/col"</span>
<span class="mh">0x00007fffffffe080</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0038</span><span class="o">:</span> <span class="mh">0x0000000200040000</span>
<span class="err">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">code</span><span class="o">:</span><span class="n">x86</span><span class="o">:</span><span class="mi">64</span> <span class="err">────</span>
   <span class="mh">0x5555555551a1</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">60</span><span class="o">&gt;</span> <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbx</span><span class="o">+</span><span class="mh">0x7e04fc7d</span><span class="p">],</span> <span class="n">eax</span>
   <span class="mh">0x5555555551a7</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">66</span><span class="o">&gt;</span> <span class="n">fisttp</span> <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbx</span><span class="o">-</span><span class="mh">0x67b707bb</span><span class="p">]</span>
   <span class="mh">0x5555555551ad</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">72</span><span class="o">&gt;</span> <span class="n">pop</span>    <span class="n">rbp</span>
 <span class="err">→</span> <span class="mh">0x5555555551ae</span> <span class="o">&lt;</span><span class="n">check_password</span><span class="o">+</span><span class="mi">73</span><span class="o">&gt;</span> <span class="n">ret</span>    
   <span class="err">↳</span>  <span class="mh">0x555555555225</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">118</span><span class="o">&gt;</span>       <span class="n">mov</span>    <span class="n">rdx</span><span class="p">,</span> <span class="n">rax</span>
      <span class="mh">0x555555555228</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">121</span><span class="o">&gt;</span>       <span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span> <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x2e19</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x555555558048</span> <span class="o">&lt;</span><span class="n">hashcode</span><span class="o">&gt;</span>
      <span class="mh">0x55555555522f</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">128</span><span class="o">&gt;</span>       <span class="n">cmp</span>    <span class="n">rdx</span><span class="p">,</span> <span class="n">rax</span>
      <span class="mh">0x555555555232</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">131</span><span class="o">&gt;</span>       <span class="n">jne</span>    <span class="mh">0x55555555524c</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">157</span><span class="o">&gt;</span>
      <span class="mh">0x555555555234</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">133</span><span class="o">&gt;</span>       <span class="n">lea</span>    <span class="n">rdi</span><span class="p">,</span> <span class="p">[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xe08</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x555555556043</span>
      <span class="mh">0x55555555523b</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">140</span><span class="o">&gt;</span>       <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span> <span class="mh">0x0</span>
<span class="err">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">threads</span> <span class="err">────</span>
<span class="p">[</span><span class="err">#</span><span class="mi">0</span><span class="p">]</span> <span class="n">Id</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Name</span><span class="o">:</span> <span class="s">"col"</span><span class="p">,</span> <span class="n">stopped</span><span class="p">,</span> <span class="n">reason</span><span class="o">:</span> <span class="n">BREAKPOINT</span>
<span class="err">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="n">trace</span> <span class="err">────</span>
<span class="p">[</span><span class="err">#</span><span class="mi">0</span><span class="p">]</span> <span class="mh">0x5555555551ae</span> <span class="err">→</span> <span class="n">check_password</span><span class="p">()</span>
<span class="p">[</span><span class="err">#</span><span class="mi">1</span><span class="p">]</span> <span class="mh">0x555555555225</span> <span class="err">→</span> <span class="n">main</span><span class="p">()</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="n">gef</span><span class="err">➤</span>
</code></pre></div></div>
<p><br> The return value of <code class="highlighter-rouge">check_password()</code> is saved in <code class="highlighter-rouge">EAX</code> we need it to be <code class="highlighter-rouge">568134124</code> :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gef</span><span class="err">➤</span>  <span class="n">print</span> <span class="err">$</span><span class="n">eax</span>
<span class="err">$</span><span class="mi">1</span> <span class="o">=</span> <span class="mh">0x46464645</span>
<span class="n">gef</span><span class="err">➤</span>  <span class="n">set</span> <span class="err">$</span><span class="n">eax</span><span class="o">=</span><span class="mi">568134124</span>
</code></pre></div></div>
<p><br> Now if we continue execution it should attempt to execute <code class="highlighter-rouge">/bin/cat flag</code> :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gef</span><span class="err">➤</span>  <span class="n">c</span>
<span class="n">Continuing</span><span class="p">.</span>
<span class="p">[</span><span class="n">Detaching</span> <span class="n">after</span> <span class="n">fork</span> <span class="n">from</span> <span class="n">child</span> <span class="n">process</span> <span class="mi">3166</span><span class="p">]</span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">cat</span><span class="o">:</span> <span class="n">flag</span><span class="o">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="n">or</span> <span class="n">directory</span>
<span class="p">[</span><span class="n">Inferior</span> <span class="mi">1</span> <span class="p">(</span><span class="n">process</span> <span class="mi">3101</span><span class="p">)</span> <span class="n">exited</span> <span class="n">normally</span><span class="p">]</span>
<span class="n">gef</span><span class="err">➤</span> 
</code></pre></div></div>
<p><br> Great, now we need to find out how to make <code class="highlighter-rouge">check_password()</code> return that value, let’s look at the code.
<br> <code class="highlighter-rouge">check_password()</code> :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">check_password</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span><span class="p">){</span>
	<span class="kt">int</span><span class="o">*</span> <span class="n">ip</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">res</span> <span class="o">+=</span> <span class="n">ip</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p><br> This function casts the given passcode (<code class="highlighter-rouge">p</code>) into integer, declares <code class="highlighter-rouge">ip</code> which is an <a href="https://www.tutorialspoint.com/cprogramming/c_array_of_pointers.htm" target="_blank" rel="noopener noreferrer">array of pointers</a> starting with the pointer to <code class="highlighter-rouge">p</code>, and declares an <code class="highlighter-rouge">int</code> variable called <code class="highlighter-rouge">res</code> and gives it a value of <code class="highlighter-rouge">0</code> then it loops 5 times through <code class="highlighter-rouge">ip</code> (because length of <code class="highlighter-rouge">passcode</code> is 20, <code class="highlighter-rouge">20/4 == 5</code>) and adds each value to <code class="highlighter-rouge">res</code>, finally it returns <code class="highlighter-rouge">res</code>.
<br> In case you’re confused, simply what happens is that it takes the given passcode which is 20 bytes length and divides it to 5 pieces (each piece 4 bytes) then it sums the decimal value of the 5 pieces and returns that value. For example the result of giving <code class="highlighter-rouge">check_password()</code> “AAAAAAAAAAAAAAAAAAAA” will be like this :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"AAAA"</span> <span class="o">+</span> <span class="s">"AAAA"</span> <span class="o">+</span> <span class="s">"AAAA"</span> <span class="o">+</span> <span class="s">"AAAA"</span> <span class="o">+</span> <span class="s">"AAAA"</span>
<span class="mh">0x41414141</span> <span class="o">+</span> <span class="mh">0x41414141</span> <span class="o">+</span> <span class="mh">0x41414141</span> <span class="o">+</span> <span class="mh">0x41414141</span> <span class="o">+</span> <span class="mh">0x41414141</span>
<span class="mi">1094795585</span> <span class="o">+</span> <span class="mi">1094795585</span> <span class="o">+</span> <span class="mi">1094795585</span> <span class="o">+</span> <span class="mi">1094795585</span> <span class="o">+</span> <span class="mi">1094795585</span>
<span class="n">res</span> <span class="o">=</span> <span class="mi">5473977925</span>
</code></pre></div></div>
<p><br> To verify that I took the main code and added some <code class="highlighter-rouge">printf</code> statements, test code looks like this :</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">hashcode</span> <span class="o">=</span> <span class="mh">0x21DD09EC</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">check_password</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span><span class="p">){</span>
	<span class="kt">int</span><span class="o">*</span> <span class="n">ip</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">res</span> <span class="o">+=</span> <span class="n">ip</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">--------------------------</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"loop :  %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"piece value : %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">ip</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">argc</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"usage : %s [passcode]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"passcode length should be 20 bytes</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"hashcode : %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">hashcode</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">hashcode</span> <span class="o">==</span> <span class="n">check_password</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)){</span>
		<span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"wrong passcode.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p><br> Let’s give it 20 A’s :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/pwnable.kr/collision/test# ./test "AAAAAAAAAAAAAAAAAAAA"
hashcode : 568134124

--------------------------
loop :  0
piece value : 1094795585


--------------------------
loop :  1
piece value : 1094795585


--------------------------
loop :  2
piece value : 1094795585


--------------------------
loop :  3
piece value : 1094795585


--------------------------
loop :  4
piece value : 1094795585

wrong passcode.

</code></pre></div></div>
<p><br> You can see that the 5 pieces are of the same value which is the value of <code class="highlighter-rouge">0x41414141</code> (4 A’s) :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="mh">0x41414141</span>
<span class="mi">1094795585</span>
</code></pre></div></div>
<p><br> And if we give it <code class="highlighter-rouge">AAAABBBBCCCCDDDDEEEE</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/pwnable.kr/collision/test# ./test "AAAABBBBCCCCDDDDEEEE"         
hashcode : 568134124

--------------------------
loop :  0
piece value : 1094795585


--------------------------
loop :  1
piece value : 1111638594


--------------------------
loop :  2
piece value : 1128481603


--------------------------
loop :  3
piece value : 1145324612


--------------------------
loop :  4
piece value : 1162167621

wrong passcode.

</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="mh">0x41414141</span>
<span class="mi">1094795585</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mh">0x42424242</span>
<span class="mi">1111638594</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mh">0x43434343</span>
<span class="mi">1128481603</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mh">0x44444444</span>
<span class="mi">1145324612</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mh">0x45454545</span>
<span class="mi">1162167621</span>
</code></pre></div></div>
<p><br></p>
<hr>

<h2 id="exploitation">Exploitation</h2>
<p><br> We need to come up with 5 pieces that add up to 568134124. 
<br> We can divide the original value by 5 :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">568134124</span><span class="o">/</span><span class="mi">5</span>
<span class="mi">113626824</span>
</code></pre></div></div>
<p><br> But 568134124 isn’t divisible by 5 :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">568134124</span><span class="o">%</span><span class="mi">5</span>
<span class="mi">4</span>
</code></pre></div></div>
<p><br> We can use 113626824 as the first 4 pieces, to get the last piece we will multiply 113626824 by 4 and subtract the result from 568134124 :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">113626824</span> <span class="o">*</span> <span class="mi">4</span>
<span class="mi">454507296</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">568134124</span> <span class="o">-</span> <span class="mi">454507296</span>
<span class="mi">113626828</span>
</code></pre></div></div>
<p><br> What’s left is to convert them to hex :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">hex</span><span class="p">(</span><span class="mi">113626824</span><span class="p">)</span>
<span class="s">'0x6c5cec8'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">hex</span><span class="p">(</span><span class="mi">113626828</span><span class="p">)</span>
<span class="s">'0x6c5cecc'</span>
</code></pre></div></div>
<p><br> And because it’s little endian we will reverse the order, final payload will be :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s1">'print "\xc8\xce\xc5\x06" * 4 + "\xcc\xce\xc5\x06"'</span>
</code></pre></div></div>
<p><br> Let’s test it :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/pwnable.kr/collision/test# ./test `python -c 'print "\xc8\xce\xc5\x06" * 4 + "\xcc\xce\xc5\x06"'`                                                                 
ip : 1329747125

--------------------------
loop :  0
piece value : 113626824

--------------------------
loop :  1
piece value : 113626824

--------------------------
loop :  2
piece value : 113626824

--------------------------
loop :  3
piece value : 113626824

--------------------------
loop :  4
piece value : 113626828

/bin/cat: flag: No such file or directory
</code></pre></div></div>
<p><br> It works.
<br><img src="/images/pwn/collision/1.png" alt=""><br>
<br> And by the way what we did now is a <a href="https://learncryptography.com/hash-functions/hash-collision-attack" target="_blank" rel="noopener noreferrer">hash collision</a>, we made a hash function produce the same output for different inputs.
<br> I also wrote small python script using <code class="highlighter-rouge">pwntools</code> :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/python</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x6c5cec8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x6c5cecc</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s">'col'</span> <span class="p">,</span><span class="s">'pwnable.kr'</span> <span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s">'guest'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">2222</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">executable</span><span class="o">=</span><span class="s">'./col'</span><span class="p">,</span> <span class="n">argv</span><span class="o">=</span><span class="p">[</span><span class="s">'col'</span><span class="p">,</span><span class="n">payload</span><span class="p">])</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Flag: "</span> <span class="o">+</span> <span class="n">flag</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">r</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<p><br><img src="/images/pwn/collision/2.png" alt=""><br>
<br> pwned !
<br> That’s it , Feedback is appreciated !
<br> Don’t forget to read the <a href="/categories">other write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br> Thanks for reading.
<br> Previous pwn write-up : <a href="/pwn/bof/">pwnable.kr - bof</a>
<br></p>
<hr>


</div>





<div class="related">
  <h2>other posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/hack-the-box/jarvis/">
            Hack The Box - Jarvis
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/hack-the-box/haystack/">
            Hack The Box - Haystack
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/hack-the-box/safe/">
            Hack The Box - Safe
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>All Tags</h2>
  <div class="tag-cloud">
<a href="/tag/active-directory/" class="set-1">active-directory</a> <a href="/tag/binary-exploitation/" class="set-2">binary-exploitation</a> <a href="/tag/bsd/" class="set-1">bsd</a> <a href="/tag/buffer-overflow/" class="set-2">buffer-overflow</a> <a href="/tag/c/" class="set-2">c</a> <a href="/tag/code-analysis/" class="set-1">code-analysis</a> <a href="/tag/cryptography/" class="set-1">cryptography</a> <a href="/tag/drupal/" class="set-1">drupal</a> <a href="/tag/egghunting/" class="set-1">egghunting</a> <a href="/tag/elasticsearch/" class="set-1">elasticsearch</a> <a href="/tag/exploit-development/" class="set-2">exploit-development</a> <a href="/tag/firewall/" class="set-1">firewall</a> <a href="/tag/forensics/" class="set-1">forensics</a> <a href="/tag/ftp/" class="set-1">ftp</a> <a href="/tag/git/" class="set-1">git</a> <a href="/tag/joomla/" class="set-1">joomla</a> <a href="/tag/js/" class="set-1">js</a> <a href="/tag/kibana/" class="set-1">kibana</a> <a href="/tag/latex-injection/" class="set-1">latex-injection</a> <a href="/tag/ldap/" class="set-1">ldap</a> <a href="/tag/lfi/" class="set-1">lfi</a> <a href="/tag/linux/" class="set-5">linux</a> <a href="/tag/logstash/" class="set-1">logstash</a> <a href="/tag/networking/" class="set-2">networking</a> <a href="/tag/php/" class="set-2">php</a> <a href="/tag/pivoting/" class="set-1">pivoting</a> <a href="/tag/python/" class="set-3">python</a> <a href="/tag/rbash/" class="set-1">rbash</a> <a href="/tag/rce/" class="set-4">rce</a> <a href="/tag/reverse-engineering/" class="set-1">reverse-engineering</a> <a href="/tag/smb/" class="set-2">smb</a> <a href="/tag/snmp/" class="set-1">snmp</a> <a href="/tag/sqli/" class="set-1">sqli</a> <a href="/tag/ssh/" class="set-3">ssh</a> <a href="/tag/ssti/" class="set-1">ssti</a> <a href="/tag/steganography/" class="set-1">steganography</a> <a href="/tag/suid/" class="set-1">suid</a> <a href="/tag/web/" class="set-5">web</a> <a href="/tag/windows/" class="set-3">windows</a> <a href="/tag/windows-exploitation/" class="set-1">windows-exploitation</a> <a href="/tag/wordpress/" class="set-1">wordpress</a>
</div>
  



      </div>
    </main><footer class="site-footer">
	<center> <script src="https://www.hackthebox.eu/badge/65598"></script> </center>
  <div class="wrapper">
<div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked>
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
if (localStorage.getItem("theme") === null) {
    window.localStorage.setItem('theme', 'dark');
}
const theme = localStorage.getItem('theme');
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

if (theme === "dark") {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
} else if (theme === "light") {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
} else if  (userPrefers === "dark") {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'dark');
	document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	window.localStorage.setItem('theme', 'dark');
	document.getElementById("theme-toggle").className = 'light';
} else {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'light');
	document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	window.localStorage.setItem('theme', 'light');
	document.getElementById("theme-toggle").className = 'dark';
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    document.documentElement.setAttribute('data-theme', 'light');
		document.documentElement.classList.add('theme--light');
        document.documentElement.classList.remove('theme--dark');
		window.localStorage.setItem('theme', 'light');
	    document.getElementById("theme-toggle").className = 'dark';
	} else {
	    document.documentElement.setAttribute('data-theme', 'dark');
		document.documentElement.classList.add('theme--dark');
        document.documentElement.classList.remove('theme--light');
		window.localStorage.setItem('theme', 'dark');
	    document.getElementById("theme-toggle").className = 'light';
	}
}
</script>
</div>
  
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
